
/*++ 
 * linux/drivers/media/video/wmt_v4l2/cmos/cmos-dev-ov.c
 * WonderMedia v4l cmos device driver
*
 * Copyright c 2010  WonderMedia  Technologies, Inc.
 *
 * This program is free software: you can redistribute it and/or modify 
 * it under the terms of the GNU General Public License as published by 
 * the Free Software Foundation, either version 2 of the License, or 
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, 
 * but WITHOUT ANY WARRANTY; without even the implied warranty of 
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
 * GNU General Public License for more details. 
 *
 * You should have received a copy of the GNU General Public License 
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
*
 * WonderMedia Technologies, Inc.
 * 4F, 533, Chung-Cheng Road, Hsin-Tien, Taipei 231, R.O.C
--*/
#define CMOS_DEV_OV_C
#include "cmos-dev-ov.h"
#include "../wmt-vid.h"

#include <linux/module.h>




unsigned char ov7675_640_480[]={
0x12,0x80,0x09,0x10,0xc1,0x7f,0x11,0x80,0x3a,0x04,0x3d,0xc3,0x12,0x00,0x15,0x00,
0x17,0x13,0x18,0x01,0x32,0xbf,0x19,0x03,0x1a,0x7b,0x03,0x0a,0x0c,0x00,0x3e,0x00,
0x70,0x3a,0x71,0x35,0x72,0x11,0x73,0xf0,0xa2,0x02,0x7a,0x09,0x7b,0x0c,0x7c,0x16,
0x7d,0x28,0x7e,0x48,0x7f,0x57,0x80,0x64,0x81,0x71,0x82,0x7e,0x83,0x89,0x84,0x94,
0x85,0xa8,0x86,0xba,0x87,0xd7,0x88,0xec,0x89,0xf9,0x13,0xe0,0x00,0x00,0x10,0x00,
0x0d,0x40,0x14,0x28,0x24,0x40,0x25,0x38,0x26,0x91,0x9f,0x78,0xa0,0x68,0xa1,0x03,
0xa6,0xd8,0xa7,0xd8,0xa8,0xf0,0xa9,0x90,0xaa,0x14,0x13,0xe5,0x0e,0x61,0x0f,0x4b,
0x16,0x02,0x1e,0x27,0x21,0x02,0x22,0x91,0x29,0x07,0x33,0x0b,0x35,0x0b,0x37,0x1d,
0x38,0x71,0x39,0x2a,0x3c,0x78,0x4d,0x40,0x4e,0x20,0x69,0x00,0x6b,0x0a,0x74,0x10,
0x8d,0x4f,0x8e,0x00,0x8f,0x00,0x90,0x00,0x91,0x00,0x96,0x00,0x9a,0x80,0xb0,0x84,
0xb1,0x0c,0xb2,0x0e,0xb3,0x82,0xb8,0x0a,0x43,0x0a,0x44,0xf2,0x45,0x39,0x46,0x62,
0x47,0x3d,0x48,0x55,0x59,0x83,0x5a,0x0d,0x5b,0xcd,0x5c,0x8c,0x5d,0x77,0x5e,0x16,
0x6c,0x0a,0x6d,0x65,0x6e,0x11,0x6f,0x97,0x43,0xa ,0x44,0xf2,0x45,0x15,0x46,0x40,   
0x47,0x1d,0x48,0x38,0x59,0xa2,0x5a,0x98,0x5b,0xcd,0x5c,0x70,0x5d,0x73,0x5e,0x18,
0x6c,0xa,0x6d,0x65,0x6e,0x11,0x6f,0x9e,0x6a,0x40,0x01,0x56,0x02,0x44,0x13,0xe7,
0x4f,0x87,0x50,0x68,0x51,0x1e,0x52,0x15,0x53,0x7c,0x54,0x91,0x58,0x1e,0x55,0x00,
0x56,0x40,0x57,0x80,0x41,0x38,0x3f,0x00,0x75,0x03,0x76,0x60,0x4c,0x00,0x77,0x01,
0x4b,0x09,0xc9,0x30,0x34,0x11,0x3b,0x12,0xa4,0x88,0x96,0x00,0x97,0x30,0x98,0x20,
0x99,0x30,0x9a,0x84,0x9b,0x29,0x9c,0x03,0x9d,0x99,0x9e,0x7f,0xa5,0x02,0xab,0x02,
0x66,0x05,0x62,0x10,0x63,0x0b,0x65,0x07,0x64,0x0f,0x94,0x0e,0x95,0x10,0x78,0x04,
0x79,0x01,0xc8,0xf0,0x79,0x0f,0xc8,0x00,0x79,0x10,0xc8,0x7e,0x79,0x0a,0xc8,0x80,
0x79,0x0b,0xc8,0x01,0x79,0x0c,0xc8,0xf ,0x79,0x0d,0xc8,0x20,0x79,0x09,0xc8,0x80,
0x79,0x02,0xc8,0xc0,0x79,0x03,0xc8,0x40,0x79,0x05,0xc8,0x30,0x79,0x26,0x76,0xe0,
0xa4,0x81,0x14,0x28,0x3b,0xe2,0xcf,0x8c,0x3b,0xe2,0xcf,0x84,0x3b,0xc2,0xcf,0x84,
0x3b,0x62,0x09,0x00
};

unsigned char ov7675_640_480_raw[]={
 0x12, 0x80, 0x09, 0x10, 0xc1, 0x7f, 0x11, 0x80, 0x3a, 0x0c, 0x3d, 0xc0, 0x12, 0x00, 0x15, 0x40,
 0x17, 0x13, 0x18, 0x01, 0x32, 0xbf, 0x19, 0x02, 0x1a, 0x7a, 0x03, 0x0a, 0x0c, 0x00, 0x3e, 0x00,
 0x70, 0x3a, 0x71, 0x35, 0x72, 0x11, 0x73, 0xf0, 0xa2, 0x02, 0x7a, 0x20, 0x7b, 0x03, 0x7c, 0x0a,
 0x7d, 0x1a, 0x7e, 0x3f, 0x7f, 0x4e, 0x80, 0x5b, 0x81, 0x68, 0x82, 0x75, 0x83, 0x7f, 0x84, 0x89,
 0x85, 0x9a, 0x86, 0xa6, 0x87, 0xbd, 0x88, 0xd3, 0x89, 0xe8, 0x13, 0xe0, 0x00, 0x00, 0x10, 0x00,
 0x0d, 0x40, 0x14, 0x28, 0xa5, 0x02, 0xab, 0x02, 0x24, 0x68, 0x25, 0x58, 0x26, 0xc2, 0x9f, 0x78,
 0xa0, 0x68, 0xa1, 0x03, 0xa6, 0xd8, 0xa7, 0xd8, 0xa8, 0xf0, 0xa9, 0x90, 0xaa, 0x14, 0x13, 0xe5,
 0x0e, 0x61, 0x0f, 0x4b, 0x16, 0x02, 0x1e, 0x07, 0x21, 0x02, 0x22, 0x91, 0x29, 0x07, 0x33, 0x0b,
 0x35, 0x0b, 0x37, 0x1d, 0x38, 0x71, 0x39, 0x2a, 0x3c, 0x78, 0x4d, 0x40, 0x4e, 0x20, 0x69, 0x00,
 0x6b, 0x0a, 0x74, 0x10, 0x8d, 0x4f, 0x8e, 0x00, 0x8f, 0x00, 0x90, 0x00, 0x91, 0x00, 0x96, 0x00,
 0x9a, 0x80, 0xb0, 0x84, 0xb1, 0x0c, 0xb2, 0x0e, 0xb3, 0x82, 0xb8, 0x0a, 0x43, 0x0a, 0x44, 0xf2,
 0x45, 0x39, 0x46, 0x62, 0x47, 0x3d, 0x48, 0x55, 0x59, 0x83, 0x5a, 0x0d, 0x5b, 0xcd, 0x5c, 0x8c,
 0x5d, 0x77, 0x5e, 0x16, 0x6c, 0x0a, 0x6d, 0x65, 0x6e, 0x11, 0x6f, 0x9e, 0x6a, 0x40, 0x01, 0x56,
 0x02, 0x44, 0x13, 0xe7, 0x4f, 0x88, 0x50, 0x8b, 0x51, 0x04, 0x52, 0x11, 0x53, 0x8c, 0x54, 0x9d,
 0x55, 0x00, 0x56, 0x40, 0x57, 0x80, 0x58, 0x9a, 0x41, 0x08, 0x3f, 0x00, 0x75, 0x04, 0x76, 0x60,
 0x4c, 0x00, 0x77, 0x01, 0x3d, 0xc2, 0x4b, 0x09, 0xc9, 0x30, 0x41, 0x38, 0x56, 0x40, 0x34, 0x11,
 0x3b, 0x12, 0xa4, 0x88, 0x96, 0x00, 0x97, 0x30, 0x98, 0x20, 0x99, 0x30, 0x9a, 0x84, 0x9b, 0x29,
 0x9c, 0x03, 0x9d, 0x99, 0x9e, 0x7f, 0x78, 0x04, 0x79, 0x01, 0xc8, 0xf0, 0x79, 0x0f, 0xc8, 0x00,
 0x79, 0x10, 0xc8, 0x7e, 0x79, 0x0a, 0xc8, 0x80, 0x79, 0x0b, 0xc8, 0x01, 0x79, 0x0c, 0xc8, 0x0f,
 0x79, 0x0d, 0xc8, 0x20, 0x79, 0x09, 0xc8, 0x80, 0x79, 0x02, 0xc8, 0xc0, 0x79, 0x03, 0xc8, 0x40,
 0x79, 0x05, 0xc8, 0x30, 0x79, 0x26, 0x62, 0x00, 0x63, 0x00, 0x64, 0x06, 0x65, 0x00, 0x66, 0x05,
 0x94, 0x05, 0x95, 0x09, 0x2a, 0x10, 0x2b, 0xc2, 0x15, 0x00, 0x3a, 0x04, 0x3d, 0xc3, 0x19, 0x03,
 0x1a, 0x7b, 0x2a, 0x00, 0x2b, 0x00, 0x18, 0x01, 0x12, 0x01, 0x3d, 0x08, 0x17, 0x12, 0x18, 0x00,
 0x32, 0x80, 0x66, 0x05, 0x62, 0x10, 0x63, 0x0b, 0x65, 0x07, 0x64, 0x0f, 0x94, 0x0e, 0x95, 0x10,
 0x4f, 0x87, 0x50, 0x68, 0x51, 0x1e, 0x52, 0x15, 0x53, 0x7c, 0x54, 0x91, 0x58, 0x1e, 0x41, 0x38,
 0x76, 0xe0, 0x24, 0x40, 0x25, 0x38, 0x26, 0x91, 0x7a, 0x09, 0x7b, 0x0c, 0x7c, 0x16, 0x7d, 0x28,
 0x7e, 0x48, 0x7f, 0x57, 0x80, 0x64, 0x81, 0x71, 0x82, 0x7e, 0x83, 0x89, 0x84, 0x94, 0x85, 0xa8,
 0x86, 0xba, 0x87, 0xd7, 0x88, 0xec, 0x89, 0xf9, 0x09, 0x00
 };



unsigned char ov7675_320_240[]={
0x12,0x80,0x09,0x10,0xc1,0x7f,0x11,0x80,0x3a,0x04,0x3d,0xc3,0x12,0x00,0x15,0x00,
0x17,0x13,0x18,0x01,0x32,0xbf,0x19,0x03,0x1a,0x7b,0x03,0x0a,0x0c,0x00,0x3e,0x00,
0x70,0x3a,0x71,0x35,0x72,0x11,0x73,0xf0,0xa2,0x02,0x7a,0x09,0x7b,0x0c,0x7c,0x16,
0x7d,0x28,0x7e,0x48,0x7f,0x57,0x80,0x64,0x81,0x71,0x82,0x7e,0x83,0x89,0x84,0x94,
0x85,0xa8,0x86,0xba,0x87,0xd7,0x88,0xec,0x89,0xf9,0x13,0xe0,0x00,0x00,0x10,0x00,
0x0d,0x40,0x14,0x28,0x24,0x40,0x25,0x38,0x26,0x91,0x9f,0x78,0xa0,0x68,0xa1,0x03,
0xa6,0xd8,0xa7,0xd8,0xa8,0xf0,0xa9,0x90,0xaa,0x14,0x13,0xe5,0x0e,0x61,0x0f,0x4b,
0x16,0x02,0x1e,0x27,0x21,0x02,0x22,0x91,0x29,0x07,0x33,0x0b,0x35,0x0b,0x37,0x1d,
0x38,0x71,0x39,0x2a,0x3c,0x78,0x4d,0x40,0x4e,0x20,0x69,0x00,0x6b,0x0a,0x74,0x10,
0x8d,0x4f,0x8e,0x00,0x8f,0x00,0x90,0x00,0x91,0x00,0x96,0x00,0x9a,0x80,0xb0,0x84,
0xb1,0x0c,0xb2,0x0e,0xb3,0x82,0xb8,0x0a,0x43,0x0a,0x44,0xf2,0x45,0x39,0x46,0x62,
0x47,0x3d,0x48,0x55,0x59,0x83,0x5a,0x0d,0x5b,0xcd,0x5c,0x8c,0x5d,0x77,0x5e,0x16,
0x6c,0x0a,0x6d,0x65,0x6e,0x11,0x6f,0x97,0x43,0xa ,0x44,0xf2,0x45,0x15,0x46,0x40,   
0x47,0x1d,0x48,0x38,0x59,0xa2,0x5a,0x98,0x5b,0xcd,0x5c,0x70,0x5d,0x73,0x5e,0x18,
0x6c,0xa,0x6d,0x65,0x6e,0x11,0x6f,0x9e,0x6a,0x40,0x01,0x56,0x02,0x44,0x13,0xe7,
0x4f,0x87,0x50,0x68,0x51,0x1e,0x52,0x15,0x53,0x7c,0x54,0x91,0x58,0x1e,0x55,0x00,
0x56,0x40,0x57,0x80,0x41,0x38,0x3f,0x00,0x75,0x03,0x76,0x60,0x4c,0x00,0x77,0x01,
0x4b,0x09,0xc9,0x30,0x34,0x11,0x3b,0x12,0xa4,0x88,0x96,0x00,0x97,0x30,0x98,0x20,
0x99,0x30,0x9a,0x84,0x9b,0x29,0x9c,0x03,0x9d,0x99,0x9e,0x7f,0xa5,0x02,0xab,0x02,
0x66,0x05,0x62,0x10,0x63,0x0b,0x65,0x07,0x64,0x0f,0x94,0x0e,0x95,0x10,0x78,0x04,
0x79,0x01,0xc8,0xf0,0x79,0x0f,0xc8,0x00,0x79,0x10,0xc8,0x7e,0x79,0x0a,0xc8,0x80,
0x79,0x0b,0xc8,0x01,0x79,0x0c,0xc8,0xf ,0x79,0x0d,0xc8,0x20,0x79,0x09,0xc8,0x80,
0x79,0x02,0xc8,0xc0,0x79,0x03,0xc8,0x40,0x79,0x05,0xc8,0x30,0x79,0x26,0x76,0xe0,
0xa4,0x81,0x14,0x28,0x3b,0xe2,0xcf,0x8c,0x3b,0xe2,0xcf,0x84,0x3b,0xc2,0xcf,0x84,
0x3b,0x62,0x09,0x00,0x17,0x13,0x18,0x3b,0x32,0x89,0x19,0x02,0x1A,0x3e,0x03,0x0a,
0xbc,0x12,0x92,0x88,0xb9,0x30,0xe6,0x05,0xe4,0x00,0xe5,0xeb,0xbf,0x00,0xbe,0x00,
0x3e,0x00,0xd2,0x1c,0x1b,0x08,0x75,0x04,0x6f,0x9e,0xb7,0x26,0x6b,0x0a,0x11,0x00,
0x2a,0x00,0x2b,0x00,0x9d,0xF3,0x9e,0xCB,0xa5,0x02,0xab,0x03,
};
int cmos_ov7675_identify(void)
{
	char data=0x0;
	data = wmt_vid_i2c_read(CMOS_OV7675_I2C_ADDR ,0xa) ;
	if (data==0x76){
		printk("find cmos device OV7675\n");
		return 0;
	}
	return -1;
}

void ov7675_cfg_rgb(void)
{
      wmt_vid_i2c_write( CMOS_OV7675_I2C_ADDR, 0x12, 0x04);
      wmt_vid_i2c_write( CMOS_OV7675_I2C_ADDR, 0x40, 0xd0);
}

int cmos_init_ov7675(cmos_init_arg_t  *init_arg)
{
    char *array_addr;
    char  addr,data;
    int   array_size, i;

    printk(" cmos_init_ov7675() \n");
    if (init_arg->is_rawdata)
    {    
    	    if(init_arg->width == 640)  {
	        array_size = sizeof(ov7675_640_480_raw);
	        array_addr = ov7675_640_480_raw;
    	    }else{
    	    	  /* Not-supported Resolution */
	        return -1;
    	    } 
    }else {
    	    if( (init_arg->width == 320) && (init_arg->height == 240) ) {
	        array_size = sizeof(ov7675_320_240);
	        array_addr = ov7675_320_240;
	    }  
	    else if(init_arg->width == 640)  {
	        array_size = sizeof(ov7675_640_480);
	        array_addr = ov7675_640_480;
	    }else{
	        /* Not-supported Resolution */
	        return -1;
	    }
	    
    }    
    
    for (i = 0; i <array_size ; i+=2){
        addr = array_addr[i];
        data = array_addr[i+1];

        wmt_vid_i2c_write( CMOS_OV7675_I2C_ADDR, addr, data);
  }    
    
    	if (((init_arg->pix_color_format == V4L2_PIX_FMT_RGB565)
    		||(init_arg->pix_color_format == V4L2_PIX_FMT_RGB32))
    		&& (!init_arg->is_rawdata))
    	{
    	       printk("ov7675_cfg_rgb \n");
		ov7675_cfg_rgb();
	}

    	data = 0x0;
	if (init_arg->cmos_v_flip)
		data |= 0x10;
	
	if (init_arg->cmos_h_flip)
		data |= 0x20;
	printk("set ov7675 mirror val 0x%02x cmos_v_flip 0x%02x cmos_h_flip 0x%02x\n",data, init_arg->cmos_v_flip, init_arg->cmos_h_flip);
       wmt_vid_i2c_write( CMOS_OV7675_I2C_ADDR, 0x1e, data);

       return 0;
} /* End of cmos_init_ov7675() */
int cmos_exit_ov7675(void)
{
 	return 0;
}


unsigned short ov5640_640_480[]={	
	0x3103, 0x11, 0x3008, 0x82, 0x3008, 0x42, 0x3103, 0x03, 0x3017, 0xFF,
	0x3018, 0xFF, 0x3034, 0x1A, 0x3035, 0x11, 0x3036, 0x46, 0x3037, 0x13,
	0x3108, 0x01, 0x3630, 0x2E, 0x3632, 0xE2, 0x3633, 0x23, 0x3621, 0xE0,
	0x3704, 0xA0, 0x3703, 0x5A, 0x3715, 0x78, 0x3717, 0x01, 0x370B, 0x60,
	0x3705, 0x1A, 0x3905, 0x02, 0x3906, 0x10, 0x3901, 0x0A, 0x3731, 0x12,
	0x3600, 0x08, 0x3601, 0x33, 0x302D, 0x60, 0x3620, 0x52, 0x371B, 0x20,
	0x471C, 0x50, 0x3A18, 0x00, 0x3A19, 0xF8, 0x3635, 0x1C, 0x3634, 0x40,
	0x3622, 0x01, 0x3C01, 0x34, 0x3C04, 0x28, 0x3C05, 0x98, 0x3C06, 0x00,
	0x3C07, 0x08, 0x3C08, 0x00, 0x3C09, 0x1C, 0x3C0A, 0x9C, 0x3C0B, 0x40,
	0x3820, 0x47, 0x3821, 0x01, 0x3814, 0x31, 0x3815, 0x31, 0x3800, 0x00,
	0x3801, 0x00, 0x3802, 0x00, 0x3803, 0x04, 0x3804, 0x0A, 0x3805, 0x3F,
	0x3806, 0x07, 0x3807, 0x9B, 0x3808, 0x02, 0x3809, 0x80, 0x380A, 0x01,
	0x380B, 0xE0, 0x380C, 0x07, 0x380D, 0x68, 0x380E, 0x03, 0x380F, 0xD8,
	0x3810, 0x00, 0x3811, 0x10, 0x3812, 0x00, 0x3813, 0x06, 0x3618, 0x00,
	0x3612, 0x29, 0x3708, 0x62, 0x3709, 0x52, 0x370C, 0x03, 0x3A02, 0x03,
	0x3A03, 0xD8, 0x3A08, 0x01, 0x3A09, 0x27, 0x3A0A, 0x00, 0x3A0B, 0xF6,
	0x3A0E, 0x03, 0x3A0D, 0x04, 0x3A14, 0x03, 0x3A15, 0xD8, 0x4001, 0x02,
	0x4004, 0x02, 0x3000, 0x00, 0x3002, 0x1C, 0x3004, 0xFF, 0x3006, 0xC3,
	0x300E, 0x58, 0x302E, 0x00, 0x4300, 0x30, 0x501F, 0x00, 0x4713, 0x03,
	0x4407, 0x04, 0x460B, 0x35, 0x460C, 0x22, 0x3824, 0x02, 0x5000, 0xA7,
	0x5001, 0xA3, 0x3406, 0x00, 0x5192, 0x04, 0x5191, 0xF8, 0x5193, 0x70,
	0x5194, 0xF0, 0x5195, 0xF0, 0x518D, 0x3D, 0x518F, 0x54, 0x518E, 0x3D,
	0x5190, 0x54, 0x518B, 0xA8, 0x518C, 0xA8, 0x5187, 0x18, 0x5188, 0x18,
	0x5189, 0x6E, 0x518A, 0x68, 0x5186, 0x1C, 0x5181, 0x50, 0x5184, 0x25,
	0x5182, 0x11, 0x5183, 0x14, 0x5184, 0x25, 0x5185, 0x24, 0x5381, 0x1C,
	0x5382, 0x5A, 0x5383, 0x06, 0x5384, 0x0A, 0x5385, 0x7E, 0x5386, 0x88,
	0x5387, 0x7C, 0x5388, 0x6C, 0x5389, 0x10, 0x538A, 0x01, 0x538B, 0x98,
	0x5300, 0x08, 0x5301, 0x30, 0x5302, 0x10, 0x5303, 0x00, 0x5304, 0x08,
	0x5305, 0x30, 0x5306, 0x08, 0x5307, 0x16, 0x5309, 0x08, 0x530A, 0x30,
	0x530B, 0x04, 0x530C, 0x06, 0x5480, 0x01, 0x5481, 0x08, 0x5482, 0x14,
	0x5483, 0x28, 0x5484, 0x51, 0x5485, 0x65, 0x5486, 0x71, 0x5487, 0x7D,
	0x5488, 0x87, 0x5489, 0x91, 0x548A, 0x9A, 0x548B, 0xAA, 0x548C, 0xB8,
	0x548D, 0xCD, 0x548E, 0xDD, 0x548F, 0xEA, 0x5490, 0x1D, 0x5580, 0x02,
	0x5583, 0x40, 0x5584, 0x10, 0x5589, 0x10, 0x558A, 0x00, 0x558B, 0xF8,
	0x5800, 0x23, 0x5801, 0x15, 0x5802, 0x10, 0x5803, 0x10, 0x5804, 0x15,
	0x5805, 0x23, 0x5806, 0x0C, 0x5807, 0x08, 0x5808, 0x05, 0x5809, 0x05,
	0x580A, 0x08, 0x580B, 0x0C, 0x580C, 0x07, 0x580D, 0x03, 0x580E, 0x00,
	0x580F, 0x00, 0x5810, 0x03, 0x5811, 0x07, 0x5812, 0x07, 0x5813, 0x03,
	0x5814, 0x00, 0x5815, 0x00, 0x5816, 0x03, 0x5817, 0x07, 0x5818, 0x0B,
	0x5819, 0x08, 0x581A, 0x05, 0x581B, 0x05, 0x581C, 0x07, 0x581D, 0x0B,
	0x581E, 0x2A, 0x581F, 0x16, 0x5820, 0x11, 0x5821, 0x11, 0x5822, 0x15,
	0x5823, 0x29, 0x5824, 0xBF, 0x5825, 0xAF, 0x5826, 0x9F, 0x5827, 0xAF,
	0x5828, 0xDF, 0x5829, 0x6F, 0x582A, 0x8E, 0x582B, 0xAB, 0x582C, 0x9E,
	0x582D, 0x7F, 0x582E, 0x4F, 0x582F, 0x89, 0x5830, 0x86, 0x5831, 0x98,
	0x5832, 0x6F, 0x5833, 0x4F, 0x5834, 0x6E, 0x5835, 0x7B, 0x5836, 0x7E,
	0x5837, 0x6F, 0x5838, 0xDE, 0x5839, 0xBF, 0x583A, 0x9F, 0x583B, 0xBF,
	0x583C, 0xEC, 0x5025, 0x00, 0x3A0F, 0x30, 0x3A10, 0x28, 0x3A1B, 0x30,
	0x3A1E, 0x26, 0x3A11, 0x60, 0x3A1F, 0x14, 0x3008, 0x02, 0x3035, 0x21	
};

unsigned short ov5640_config_5M[]={	
0x3035,0x21,0x3036,0x54,0x3C07,0x07,0x3820,0x40,0x3821,0x06,0x3814,0x11,
0x3815,0x11,0x3800,0x00,0x3801,0x00,0x3802,0x00,0x3803,0x00,0x3804,0x0a,
0x3805,0x3f,0x3806,0x07,0x3807,0x9f,0x3808,0x0a,0x3809,0x20,0x380A,0x07,
0x380B,0x98,0x380C,0x0b,0x380D,0x1C,0x380E,0x07,0x380F,0xb0,0x3813,0x04,
0x3618,0x04,0x3612,0x2B,0x3708,0x21,0x3709,0x12,0x370C,0x00,0x3A02,0x07,
0x3A03,0xB0,0x3A0E,0x06,0x3A0D,0x08,0x3A14,0x07,0x3A15,0xD0,0x4004,0x06,
0x4713,0x02,0x4407,0x0C,0x460B,0x37,0x460C,0x20,0x3824,0x01,0x5001,0x83,
0x3008,0x02,0x3002,0x1c,0x3006,0xc3,0x4713,0x02,0x4407,0x0c,0x460b,0x35,
0x460c,0x20,0x3824,0x01,0x4003,0x82,0x4003,0x08,
};

unsigned short ov5640_config_VGA[]={	
0x3035,0x11,0x3036,0x38,0x3C07,0x08,0x3820,0x41,0x3821,0x07,0x3814,0x31,
0x3815,0x31,0x3800,0x00,0x3801,0x00,0x3802,0x00,0x3803,0x04,0x3804,0x0a,
0x3805,0x3f,0x3806,0x07,0x3807,0x9B,0x3808,0x02,0x3809,0x80,0x380A,0x01,
0x380B,0xE0,0x380C,0x07,0x380D,0x68,0x380E,0x03,0x380F,0xD8,0x3813,0x06,
0x3618,0x00,0x3612,0x29,0x3708,0x62,0x3709,0x52,0x370C,0x03,0x3A02,0x03,
0x3A03,0xD8,0x3A0E,0x03,0x3A0D,0x04,0x3A14,0x03,0x3A15,0xD8,0x4004,0x02,
0x4713,0x03,0x4407,0x04,0x460B,0x35,0x460C,0x22,0x3824,0x02,0x5001,0xA3,
0x3008,0x02,0x3002,0x1c,0x3006,0xc3,0x4713,0x02,0x4407,0x0c,0x460b,0x35,
0x460c,0x20,0x3824,0x01,0x3a08,0x01,0x3a09,0x27,0x3a0a,0x00,0x3a0b,0xf6,
0x3a0e,0x03,0x3a0d,0x04,0x4003,0x82,0x4003,0x08,
};



unsigned short ov5640_2592_1944[]={	

	0x3103,0x11,0x3008,0x82,0x3008,0x42,0x3103,0x03,0x3017,0xff,
	0x3018,0xff,0x3034,0x1a,0x3035,0x21/*0x21*/,0x3036,0x69,0x3037,0x13,
	0x3108,0x01,0x3630,0x36,0x3631,0x0e,0x3632,0xe2,0x3633,0x12,
	0x3621,0xe0,0x3704,0xa0,0x3703,0x5a,0x3715,0x78,0x3717,0x01,
	0x370b,0x60,0x3705,0x1a,0x3905,0x02,0x3906,0x10,0x3901,0x0a,
	0x3731,0x12,0x3600,0x08,0x3601,0x33,0x302d,0x60,0x3620,0x52,
	0x371b,0x20,0x471c,0x50,0x3a13,0x43,0x3a18,0x00,0x3a19,0xf8,
	0x3635,0x13,0x3636,0x03,0x3634,0x40,0x3622,0x01,0x3c01,0x34,
	0x3c04,0x28,0x3c05,0x98,0x3c06,0x00,0x3c07,0x07,0x3c08,0x00,
	0x3c09,0x1c,0x3c0a,0x9c,0x3c0b,0x40,0x3820,0x40,0x3821,0x06,
	0x3814,0x11,0x3815,0x11,0x3800,0x00,0x3801,0x00,0x3802,0x00,
	0x3803,0x00,0x3804,0x0a,0x3805,0x3f,0x3806,0x07,0x3807,0x9f,
	0x3808,0x0a,0x3809,0x20,0x380a,0x07,0x380b,0x98,0x380c,0x0b,
	0x380d,0x1c,0x380e,0x07,0x380f,0xb0,0x3810,0x00,0x3811,0x10,
	0x3812,0x00,0x3813,0x04,0x3618,0x04,0x3612,0x2b,0x3708,0x64,
	0x3709,0x12,0x370c,0x00,0x3a02,0x07,0x3a03,0xb0,0x3a08,0x01,
	0x3a09,0x27,0x3a0a,0x00,0x3a0b,0xf6,0x3a0e,0x06,0x3a0d,0x08,
	0x3a14,0x07,0x3a15,0xb0,0x4001,0x02,0x4004,0x06,0x3000,0x00,
	0x3002,0x1c,0x3004,0xff,0x3006,0xc3,0x300e,0x58,0x302e,0x00,
	0x4300,0x30,0x4837,0x2c,0x501f,0x00,0x440e,0x00,0x5000,0xa7,
	0x5001,0x83,0x5180,0xff,0x5181,0xf2,0x5182,0x00,0x5183,0x14,
	0x5184,0x25,0x5185,0x24,0x5186,0x09,0x5187,0x09,0x5188,0x09,
	0x5189,0x75,0x518a,0x54,0x518b,0xe0,0x518c,0xb2,0x518d,0x42,
	0x518e,0x3d,0x518f,0x56,0x5190,0x46,0x5191,0xf8,0x5192,0x04,
	0x5193,0x70,0x5194,0xf0,0x5195,0xf0,0x5196,0x03,0x5197,0x01,
	0x5198,0x04,0x5199,0x12,0x519a,0x04,0x519b,0x00,0x519c,0x06,
	0x519d,0x82,0x519e,0x38,0x5381,0x1e,0x5382,0x5b,0x5383,0x08,
	0x5384,0x0a,0x5385,0x7e,0x5386,0x88,0x5387,0x7c,0x5388,0x6c,
	0x5389,0x10,0x538a,0x01,0x538b,0x98,0x5300,0x08,0x5301,0x30,
	0x5302,0x10,0x5303,0x00,0x5304,0x08,0x5305,0x30,0x5306,0x08,
	0x5307,0x16,0x5309,0x08,0x530a,0x30,0x530b,0x04,0x530c,0x06,
	0x5480,0x01,0x5481,0x08,0x5482,0x14,0x5483,0x28,0x5484,0x51,
	0x5485,0x65,0x5486,0x71,0x5487,0x7d,0x5488,0x87,0x5489,0x91,
	0x548a,0x9a,0x548b,0xaa,0x548c,0xb8,0x548d,0xcd,0x548e,0xdd,
	0x548f,0xea,0x5490,0x1d,0x5580,0x02,0x5583,0x40,0x5584,0x10,
	0x5589,0x10,0x558a,0x00,0x558b,0xf8,0x5800,0x23,0x5801,0x14,
	0x5802,0x0f,0x5803,0x0f,0x5804,0x12,0x5805,0x26,0x5806,0x0c,
	0x5807,0x08,0x5808,0x05,0x5809,0x05,0x580a,0x08,0x580b,0x0d,
	0x580c,0x08,0x580d,0x03,0x580e,0x00,0x580f,0x00,0x5810,0x03,
	0x5811,0x09,0x5812,0x07,0x5813,0x03,0x5814,0x00,0x5815,0x01,
	0x5816,0x03,0x5817,0x08,0x5818,0x0d,0x5819,0x08,0x581a,0x05,
	0x581b,0x06,0x581c,0x08,0x581d,0x0e,0x581e,0x29,0x581f,0x17,
	0x5820,0x11,0x5821,0x11,0x5822,0x15,0x5823,0x28,0x5824,0x46,
	0x5825,0x26,0x5826,0x08,0x5827,0x26,0x5828,0x64,0x5829,0x26,
	0x582a,0x24,0x582b,0x22,0x582c,0x24,0x582d,0x24,0x582e,0x06,
	0x582f,0x22,0x5830,0x40,0x5831,0x42,0x5832,0x24,0x5833,0x26,
	0x5834,0x24,0x5835,0x22,0x5836,0x22,0x5837,0x26,0x5838,0x44,
	0x5839,0x24,0x583a,0x26,0x583b,0x28,0x583c,0x42,0x583d,0xce,
	0x5025,0x00,0x3a0f,0x30,0x3a10,0x28,0x3a1b,0x30,0x3a1e,0x26,
	0x3a11,0x60,0x3a1f,0x14,0x3008,0x02
};

unsigned short ov5640_1920_1088[]={	

	0x3103,0x11,0x3008,0x82,0x3008,0x42,0x3103,0x03,0x3017,0xff,
	0x3018,0xff,0x3034,0x1a,0x3035,0x21,0x3036,0x69,0x3037,0x13,
	0x3108,0x01,0x3630,0x36,0x3631,0x0e,0x3632,0xe2,0x3633,0x12,
	0x3621,0xe0,0x3704,0xa0,0x3703,0x5a,0x3715,0x78,0x3717,0x01,
	0x370b,0x60,0x3705,0x1a,0x3905,0x02,0x3906,0x10,0x3901,0x0a,
	0x3731,0x12,0x3600,0x08,0x3601,0x33,0x302d,0x60,0x3620,0x52,
	0x371b,0x20,0x471c,0x50,0x3a13,0x43,0x3a18,0x00,0x3a19,0xf8,
	0x3635,0x13,0x3636,0x03,0x3634,0x40,0x3622,0x01,0x3c01,0x34,
	0x3c04,0x28,0x3c05,0x98,0x3c06,0x00,0x3c07,0x07,0x3c08,0x00,
	0x3c09,0x1c,0x3c0a,0x9c,0x3c0b,0x40,0x3820,0x40,0x3821,0x06,
	0x3814,0x11,0x3815,0x11,0x3800,0x00,0x3801,0x00,0x3802,0x00,
	0x3803,0x00,0x3804,0x0a,0x3805,0x3f,0x3806,0x07,0x3807,0x9f,
	0x3808,0x07,0x3809,0x80,0x380a,0x04,0x380b,0x38,0x380c,0x0b,
	0x380d,0x1c,0x380e,0x07,0x380f,0xb0,0x3810,0x00,0x3811,0x10,
	0x3812,0x00,0x3813,0x04,0x3618,0x04,0x3612,0x2b,0x3708,0x64,
	0x3709,0x12,0x370c,0x00,0x3a02,0x07,0x3a03,0xb0,0x3a08,0x01,
	0x3a09,0x27,0x3a0a,0x00,0x3a0b,0xf6,0x3a0e,0x06,0x3a0d,0x08,
	0x3a14,0x07,0x3a15,0xb0,0x4001,0x02,0x4004,0x06,0x3000,0x00,
	0x3002,0x1c,0x3004,0xff,0x3006,0xc3,0x300e,0x58,0x302e,0x00,
	0x4300,0x30,0x4837,0x2c,0x501f,0x00,0x440e,0x00,0x5000,0xa7,
	0x5001,0x83,0x5180,0xff,0x5181,0xf2,0x5182,0x00,0x5183,0x14,
	0x5184,0x25,0x5185,0x24,0x5186,0x09,0x5187,0x09,0x5188,0x09,
	0x5189,0x75,0x518a,0x54,0x518b,0xe0,0x518c,0xb2,0x518d,0x42,
	0x518e,0x3d,0x518f,0x56,0x5190,0x46,0x5191,0xf8,0x5192,0x04,
	0x5193,0x70,0x5194,0xf0,0x5195,0xf0,0x5196,0x03,0x5197,0x01,
	0x5198,0x04,0x5199,0x12,0x519a,0x04,0x519b,0x00,0x519c,0x06,
	0x519d,0x82,0x519e,0x38,0x5381,0x1e,0x5382,0x5b,0x5383,0x08,
	0x5384,0x0a,0x5385,0x7e,0x5386,0x88,0x5387,0x7c,0x5388,0x6c,
	0x5389,0x10,0x538a,0x01,0x538b,0x98,0x5300,0x08,0x5301,0x30,
	0x5302,0x10,0x5303,0x00,0x5304,0x08,0x5305,0x30,0x5306,0x08,
	0x5307,0x16,0x5309,0x08,0x530a,0x30,0x530b,0x04,0x530c,0x06,
	0x5480,0x01,0x5481,0x08,0x5482,0x14,0x5483,0x28,0x5484,0x51,
	0x5485,0x65,0x5486,0x71,0x5487,0x7d,0x5488,0x87,0x5489,0x91,
	0x548a,0x9a,0x548b,0xaa,0x548c,0xb8,0x548d,0xcd,0x548e,0xdd,
	0x548f,0xea,0x5490,0x1d,0x5580,0x02,0x5583,0x40,0x5584,0x10,
	0x5589,0x10,0x558a,0x00,0x558b,0xf8,0x5800,0x23,0x5801,0x14,
	0x5802,0x0f,0x5803,0x0f,0x5804,0x12,0x5805,0x26,0x5806,0x0c,
	0x5807,0x08,0x5808,0x05,0x5809,0x05,0x580a,0x08,0x580b,0x0d,
	0x580c,0x08,0x580d,0x03,0x580e,0x00,0x580f,0x00,0x5810,0x03,
	0x5811,0x09,0x5812,0x07,0x5813,0x03,0x5814,0x00,0x5815,0x01,
	0x5816,0x03,0x5817,0x08,0x5818,0x0d,0x5819,0x08,0x581a,0x05,
	0x581b,0x06,0x581c,0x08,0x581d,0x0e,0x581e,0x29,0x581f,0x17,
	0x5820,0x11,0x5821,0x11,0x5822,0x15,0x5823,0x28,0x5824,0x46,
	0x5825,0x26,0x5826,0x08,0x5827,0x26,0x5828,0x64,0x5829,0x26,
	0x582a,0x24,0x582b,0x22,0x582c,0x24,0x582d,0x24,0x582e,0x06,
	0x582f,0x22,0x5830,0x40,0x5831,0x42,0x5832,0x24,0x5833,0x26,
	0x5834,0x24,0x5835,0x22,0x5836,0x22,0x5837,0x26,0x5838,0x44,
	0x5839,0x24,0x583a,0x26,0x583b,0x28,0x583c,0x42,0x583d,0xce,
	0x5025,0x00,0x3a0f,0x30,0x3a10,0x28,0x3a1b,0x30,0x3a1e,0x26,
	0x3a11,0x60,0x3a1f,0x14,0x3008,0x02
};

int cmos_ov5640_identify(void)
{
	char data=0x0;
	char data1=0x0;
	printk(" cmos_ov5640_identify() \n");
	data = wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR ,0x300A) ;
	data1 = wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR ,0x300B);

	printk("cmos_ov5640_identify() data = 0x%02x, data1 =0x%02x\n",data,data1);

	if (data==0x56 && data1==0x40){
		printk("find cmos device OV5640\n");
		return 0;
	}
	return -1;
}

int is_ov5640_init =0;




int cmos_config_ov5640(cmos_init_arg_t  *init_arg)
{
    unsigned short *array_addr;
    unsigned short  addr,data;
    int   array_size, i;
	int	  ret;

	printk("cmos_config_ov5640() \n");
#if 0
	wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, 0x3808, (init_arg->width & 0xff00) >> 8);
	wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, 0x3809, init_arg->width & 0xff);
	wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, 0x380a, (init_arg->height & 0xff00) >> 8);
	wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, 0x380b, init_arg->height & 0xff);

	printk("cmos_config_ov5640 width %x %x \n",wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR,0x3808), wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR,0x3809));
	printk("cmos_config_ov5640 height %x %x \n",wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR,0x380a), wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR,0x380b));
#endif
    if(init_arg->width == 640)  {
    		printk("cmos_config_ov5640() VGA\n");

        array_size = sizeof(ov5640_config_VGA)/2;
        array_addr = ov5640_config_VGA;
    
    }else if(init_arg->width == 2592)  {
    		printk("cmos_config_ov5640() 5M\n");
    		
        array_size = sizeof(ov5640_config_5M)/2;
        array_addr = ov5640_config_5M;
    
    }else{
        /* Not-supported Resolution */
        return -1;
    }

    for (i = 0; i <array_size ; i+=2){
        addr = array_addr[i];
        data = array_addr[i+1];

	ret = wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, addr, data);

	if(ret < 0)
		return -1;
	
    }    
}

int cmos_init_ov5640(cmos_init_arg_t  *init_arg)
{
    unsigned short *array_addr;
    unsigned short  addr,data;
    int   array_size, i;
	int	  ret;
	
	printk(" cmos_init_ov5640() width = %d,height = %d\n",init_arg->width,init_arg->height);
	if (is_ov5640_init)
	{
		cmos_config_ov5640(init_arg);
		return 0;
	}

    if( (init_arg->width == 320) && (init_arg->height == 240) ) {
        //array_size = sizeof(ov7675_320_240);
        //array_addr = ov7675_320_240;
        return -1;
    }
    else if(init_arg->width == 640)  {
        array_size = sizeof(ov5640_640_480)/2;
        array_addr = ov5640_640_480;
    
    }else if(init_arg->width == 2592)  {

        array_size = sizeof(ov5640_2592_1944)/2;
        array_addr = ov5640_2592_1944;

        printk(">> ov5640_2592_1944 sizeof(ov5640_2592_1944) %d \n",sizeof(ov5640_2592_1944));
    
    }else if(init_arg->width == 1920)  {

        array_size = sizeof(ov5640_1920_1088)/2;
        array_addr = ov5640_1920_1088;

        printk(">> ov5640_1920_1088 sizeof(ov5640_1920_1088) %d \n",sizeof(ov5640_1920_1088));

    }else{
        /* Not-supported Resolution */
        return -1;
    }

    for (i = 0; i <array_size ; i+=2){
        addr = array_addr[i];
        data = array_addr[i+1];

	ret = wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, addr, data);

		if(ret < 0)
			return -1;
	
	if (0)
      	{
			char ret_data;

			ret_data = wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR, addr);
			printk("addr %x : write %x, read %x\n",addr, data, ret_data);		
      	}		
    }    
    

	if (init_arg->cmos_v_flip){
		data = wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR, 0x3820);
		data |= 0x06;
		wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, 0x3820, data);
	}
	
	if (init_arg->cmos_h_flip){
		data = wmt_vid_i2c_read16addr(CMOS_OV5640_I2C_ADDR, 0x3821);
		data |= 0x06;
		wmt_vid_i2c_write16addr( CMOS_OV5640_I2C_ADDR, 0x3821, data);
	}
	
	is_ov5640_init = 1;
	
    return 0;
} /* End of cmos_init_ov5640() */
int cmos_exit_ov5640(void)
{
 	return 0;
}


/*------------------------------------------------------------------------------*/
/*--------------------End of Function Body -----------------------------------*/

#undef CMOS_DEV_OV_C

